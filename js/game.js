"use strict";

var mymap = L.map('mapid').setView([51.9606649, 7.6161347], 13);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'hoelsch.e2b0812b',
    accessToken: 'pk.eyJ1IjoiaG9lbHNjaCIsImEiOiJxblpwakZrIn0.JTTnLszkIJB11k8YEe7raQ'}).addTo(mymap);
var popup = L.popup();
function onMapClick(e) {
popup
.setLatLng(e.latlng)
.setContent("Die Entfernung zur Sensebox beträgt: " + ((L.latLng(e.latlng).distanceTo([49.201332, 10.367305]) / 1000).toFixed(3)) + " Km" )
.openOn(mymap);
L.latLng([48.201332, 16.367305]).distanceTo([49.201332, 10.367305]);
}mymap.on('click', onMapClick);


var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope, $http) {
  $scope.boxes = {};
  var boxId = [];
  $http({
    method : "GET",
    url : "https://api.opensensemap.org/boxes?"
  }).then(function mySucces(response) {
      $scope.myData = response.data;

      for(var i in response.data){
        boxId.push(response.data[i]._id);


      }
      dosomething(boxId);
      console.log('boxes %o', boxId);
    }, function myError(response) {
      $scope.myData = response.statusText;
  });
});

function dosomething(data){
  nimm daten und return was anders;
}
//JSON.stringify($scope.myData);

//var boxID = ["5386026e5f08822009b8b60d"]; //"538da4d6a834155415765eae", "538ee6a4a83415541576b777", "5391be52a8341554157792e6", "539c00c2a83415541578eaf5", "539fec94a8341554157931d7", 53a0017aa834155415793281, 54d726661b93e970075148bd, 53a0bb21a834155415793844, 53a6ed02a8341554157a336a, 53aaffafe79c90a0102abb67, 53b2ab5de79c90a0102b04ea, 53c576f2e79c90a0102f67e9, 53c57d64e79c90a0102f6b9c, 53c6cac8e79c90a0103006fb, 53c7c650e79c90a0103096a5, 53cace31e79c90a010327bf5, 53d2c94de79c90a01037c3d5, 53edc2fde79c90a0103f3936, 540b2d53e79c90a010422568, 5411a5d5e79c90a010426e79, 545ba98b6c8bde3c13dbec42, 54b2537896ca78540fa79c91, 54d799041b93e97007515225, 54d79ea81b93e970075153f4, 54d7c2361b93e97007516a19, 54e3a091a807ade00f84b969, 54e4c395a807ade00f84e6e0, 54e51548a807ade00f84e704, 54e6fc60a807ade00f85a918, 54e73244a807ade00f85f5bd, 54e7a5faa807ade00f868aab, 54e86f19a807ade00f877342, 54e8e1dea807ade00f880978, 54e9f616a807ade00f89d3cf, 54ec441ca807ade00f8dad34, 54f1a46ba807ade00f92a4c2, 54f46237a807ade00f94eee1, 556ad8b5a807ade00fc19988, 55718516a807ade00fc1a2d9, 5571fb04a807ade00fc1a4d3, 557df59ca807ade00fc2a02b, 557e8391a807ade00fc2c249, 558bd0bca807ade00fc3be7d, 55925c11a807ade00fc3c2db, 559a128ca807ade00fc44f09, 559b7be2a807ade00fc4e6d2, 55a3a864a807ade00fc7d5ce, 55a965dda807ade00fcbac01, 55aa69a3a807ade00fcc5b91, 55acebc3a807ade00fce0d49, 55c22ef5a807ade00fd85d2c, 55cc8732a807ade00fdd3339, 55cc964ca807ade00fdd3959, 55d9d0c3a807ade00fe3bf8a, 55e60abefe6a79280c109dd8, 55e63d4f5a71c17808f8cf1b, 55e9cc7a5a71c17808fa5fbb, 55eaba115a71c17808fac22b, 55eb693c5a71c17808fb2a57, 55ec08415a71c17808fb96f5, 55ee2fb15a71c17808fd1e4f, 55f0439b5a71c17808fe8964, 55f135ccb3de1fe005b0bad3, 55f141c6b3de1fe005b0c3b3, 55f3dbdfb3de1fe005b25bd0, 55f9350cb3de1fe005b5fadd, 55f935a9b3de1fe005b5fb51, 55f93600b3de1fe005b5fb95, 55f93a3bb3de1fe005b5fe7d, 55f93b66b3de1fe005b5ff4c, 56026d07b3de1fe005bda284, 5606e52bb3de1fe005c21692, 5606e5e7b3de1fe005c21755, 5608643cb3de1fe005c394cc, 560f82d9b3de1fe005c9433d, 5612ba81b3de1fe005cbaa50, 561a0b33b3de1fe005d1afcd, 562a5bd5b3de1fe005df1fe3, 561ba6b2b3de1fe005d2edba, 561ce8acb3de1fe005d3d7bf, 562a6ce3b3de1fe005df2f21, 562b48d3b3de1fe005dfd7be, 562ba7c9b3de1fe005e019a2, 562bdcf3b3de1fe005e03d2a, 562becf9b3de1fe005e04ccf, 562e4e5bb3de1fe005e1c2af, 562e5893b3de1fe005e1cbdf, 562eae79b3de1fe005e220c4, 562ecb13b3de1fe005e2404c, 562f9798b3de1fe005e327aa, 562f9a8cb3de1fe005e32afb, 56321e3fb3de1fe005e60ad4, 5636334ab3de1fe005ea99f8, 563df00cb3de1fe005f1dcb0, 564ca7a2b3de1fe005fc64a4, 564cc76bb3de1fe005fc7321, 5656083db3de1fe0050431f8, 5656b69db3de1fe00504d29e, 5661a49eb3de1fe00508a1e9, 566449aeb3de1fe00508dcbf, 56791a8cb3de1fe00511e1a2, 567aae56b3de1fe00512d737, 567bdf45b3de1fe005138a9c, 5686bde5b3de1fe0051aeaf9, 568bc484b3de1fe0051df22d, 568e38d0b3de1fe005202a9c, 56951bdbb3de1fe00524e30a, 56952c4ab3de1fe00524f0e1, 56957f3ab3de1fe0052532da, 569583ffb3de1fe0052536c3, 5697bf642cb6e1e4103d1df0, 569910922cb6e1e4103dc9e0, 569cc5ca2cb6e1e4103f0ba4, 56a0de932cb6e1e41040a68b, 56a1f76b2cb6e1e41040e7f1, 56a355792cb6e1e410413726, 56a50ce12cb6e1e41041a4e9, 56a5832a2cb6e1e41041d2b8, 56a7e0e72cb6e1e4104308a4, 56aa62db2cb6e1e41043e7cf, 56ab272d2cb6e1e410445721, 56ac81722cb6e1e410451958, 56ad11da2cb6e1e410455f05, 56af60512cb6e1e410468410, 56af6f6f2cb6e1e410468e7a, 56b093682cb6e1e410474343, 56b3ca1a2cb6e1e410499cb5, 56b8d04d2cb6e1e4104d4df3, 56bb06402cb6e1e4104f26ff, 56c0d7162cb6e1e410567a56, 56c4d9a02cb6e1e4105ae098, 56cb84812cb6e1e41061bc99, 56cc33dd2cb6e1e41062940e, 56cf43182cb6e1e41066df3c, 56d046572cb6e1e410682a85, 56d077882cb6e1e4106868fb, 56dbebcf2cb6e1e410760bf6, 56dc3fdc2cb6e1e4107659e1, 56ded8d82cb6e1e41078f572, 56e2df922cb6e1e4107d4763, 56e3cb1e2cb6e1e4107e90d2, 56efe67c2cb6e1e4108e2124, 56f20ee62cb6e1e410912301, 56fbf16645fd40c81965ce3a, 56fc046445fd40c81965e5d2, 570622c245fd40c8197457c9, 570624ed45fd40c819745b43, 5706283d45fd40c8197460a1, 5706298845fd40c8197462a5, 570629b945fd40c8197462fb, 57062bcb45fd40c81974667e, 57062d7345fd40c81974691c, 57065ef945fd40c81974c696, 570bad2b45fd40c8197f13a2, 570d515d45fd40c81983e73a, 570f868d45fd40c81988ef89, 5710de1a45fd40c8198ccece, 5719c4037514d05c121e317c, 5719ef18744141240ff7ade5, 571b766d24a2dbec11b571dd, 571cf49424a2dbec11b571e4, 571d244a24a2dbec11b571e9, 571d333c24a2dbec11b571ee, 571db8af24a2dbec11b571f6, 571e7fa524a2dbec11b571fc, 571f567751171e3c177d8707, 5721f79824a2dbec11b57205, 5724ed52fa4e96380f1994c9, 572c692e566b8d3c11114a9a, 56c604732cb6e1e4105be1db, 572f41adfa4e96380f3bdd25, 573998b7fa4e96380f638858, 573d7629566b8d3c11114ab6, 573ca7e2fa4e96380f6e2996, 573d7649566b8d3c11114ac2, 573dc7ab566b8d3c11114aea, 573d969c566b8d3c11114ada, 573d736d566b8d3c11114aaf, 5743f43d6e89cb28190649a1, 573d6f0cfa4e96380f70ee43, 574869476e89cb28190649c8, 5706242045fd40c8197459e5, 570d755e45fd40c819843e24, 57000b8745fd40c8196ad04c, 5750220bed08f9680c6b4154, 57505cb9ed08f9680c6b415c, 573d79cc566b8d3c11114ac9, 571e05e051171e3c17786fe7, 575324f8ae6dce84059dd64e, 57585de44bab38000e49fa97, 5767cdbb4774ce7c0cac561e, 5767dd6d4774ce7c0cac6513, 5767e79e4774ce7c0cac700a, 57699c206c521810002481f0, 576a5cde6c5218100025c070, 576a7a9b22cfcc1000c885c0, 576e5eabbf95551000acc2ca, 576e9baeca0d561000b97337, 57711fb1ca0d561000bf330b, 5771790cca0d561000c0008a, 577633beca0d561000cab7c2, 5776734b230b2b1000880c0c, 577a8a96399a4f120068733f, 5780221d6fea6613008056e3, 578207d56fea661300861f3b, 57839eb8dfed80140057e346, 5783be07dfed80140058471b, 578549036778a71200d46322, 5789f327ccff9d1000b5bb9e, 578aad85ccff9d1000b7b638, 578c9c60ccff9d1000bcad19, 578cf2ccccff9d1000bd9198, 579048762ff3991300bc9240, 579084c5432e521200034011, 57946712d0a5af1100ccd9d3, 5799c394c2ed471000c1e45a, 579b23d2448d821200bea72a, 579e683668b4a21200661a6d, 579f090e68b4a21200680416, 579f117d68b4a21200682068, 579f160c68b4a21200682f33, 579f193e68b4a2120068393b, 579f1c5b68b4a21200684325, 579fa21c68b4a2120069f9c4, 579fbb7b68b4a212006a59f7, 57a4e8613e4f3f1300fae5fa, 57a703c657ef4b1200fc1a6c, 57a7226657ef4b1200fcf241, 57a98eead46eb21200e225b3, 57a98f6ad46eb21200e22909, 57a98fd0d46eb21200e22bbc, 57a99050d46eb21200e22f0f, 57a990eed46eb21200e23322, 57a991aed46eb21200e2383b, 57a991fad46eb21200e239d5, 57a99242d46eb21200e23ba8, 57a9927ed46eb21200e23d37, 57aa3052f52f21100029a5a9, 57adc82c4b63ab1100eb611f, 57b49f336fab811300b7d727, 57b6614fb17d6811001a8703, 57b6e6b9b17d6811001c218d, 57baf4a8b17d68110027f7d8, 57bb1339b17d6811002860ac, 57bc7df0bc1ab41500b178f4, 57bd3866bc1ab41500b3f5ab, 57c05245c28bed14003b0be2, 57c077a6c28bed14003b885e, 57c41ecbc28bed1400474a81, 57c9bd55c28bed14005a4c5f, 57ce86798740b514009a141e, 57d536628740b51400ab2890, 57d53db48740b51400ab3d47, 57dbc2272fc31e1600a6a931, 57dc56482fc31e1600a873fa, 57de1d3c2fc31e1600aca07f, 57dfb745410840001355ea69, 57dfb7ea410840001355ebe0, 57ed0cf133f0cd00133017a1, 57ef751733f0cd001337d09b, 57f2cd8233f0cd001340cb0b, 57f802dc11347b0011b6ea67, 57faf4d211347b0011bf9b9f, 57fb712811347b0011c10e80, 57fb863011347b0011c14e12, 57ff3ab2f1b6070012da9c06, 5802aebdf1b6070012e629fc, 58076af2cd79a20011b5abcd, 580771bacd79a20011b5c0cd, 580a3a72cd79a20011bf5671, 580a3b97cd79a20011bf5b02, 580b4821cd79a20011c3a671, 580be827cd79a20011c63a9d, 580f30787ac61b0010983265, 580fb1a47ac61b00109a509e, 5810d6af0d07460012f0b1de, 581112710d07460012f1b36b, 5813a9da0d07460012fb2f89, 5819ed81c5f60d0011b7f94f, 581a1e5502eb6400114b80bf, 581a40c602eb6400114c053d, 581dab879337ed000f6b308d, 58204e7a9337ed000f74cc10, 58233fe540198a00100b5792, 582473be40198a001010e1a3, 58249abad7492f00108833a4, 58259535d7492f00108d6066, 5826b7d40da901000fdeb492, 5827b4310da901000fe3245b, 582c72cfbecbf8000fb8dc3e, 582ca475becbf8000fb9d3f9, 5831b034de85220011c7ae3c, 5832ce9fde85220011ce158c, 5832fbb7de85220011cf133d, 58330accde85220011cf652c, 58356c6453fb45000f8b89df, 5836ed3f53fb45000f935d1b, 5837219353fb45000f9478b0, 5838218753fb45000f99c9b3, 58382f8653fb45000f9a15fc, 5838309d53fb45000f9a1bfc, 5838314953fb45000f9a1fcb, 583995fc0c40640011d68452, 583ae8c10c40640011de759f, 583ca7060c40640011e955ae, 58418d5b5850ba001602063a, 58454bb862844d0010d9bf41, 58454bf562844d0010d9c0cb, 58454c3962844d0010d9c282, 5846cff516c08e000f885edc, 5848851016c08e000f93115d];

//var randomboxID = boxID[Math.floor(Math.random()*boxID.length)];
//console.log(randomboxID);
//console.log("https://api.opensensemap.org/boxes/"+randomboxID+"/sensors");
